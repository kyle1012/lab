{"ast":null,"code":"function _classPrivateFieldLooseBase(receiver, privateKey) {\n  if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n    throw new TypeError(\"attempted to use private field on non-instance\");\n  }\n  return receiver;\n}\nvar id = 0;\nfunction _classPrivateFieldLooseKey(name) {\n  return \"__private_\" + id++ + \"_\" + name;\n}\nimport { render } from 'preact';\nimport findDOMElement from '@uppy/utils/lib/findDOMElement';\nimport getTextDirection from '@uppy/utils/lib/getTextDirection';\nimport BasePlugin from './BasePlugin.js';\n/**\n * Defer a frequent call to the microtask queue.\n *\n * @param {() => T} fn\n * @returns {Promise<T>}\n */\n\nfunction debounce(fn) {\n  let calling = null;\n  let latestArgs = null;\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    latestArgs = args;\n    if (!calling) {\n      calling = Promise.resolve().then(() => {\n        calling = null; // At this point `args` may be different from the most\n        // recent state, if multiple calls happened since this task\n        // was queued. So we use the `latestArgs`, which definitely\n        // is the most recent call.\n\n        return fn(...latestArgs);\n      });\n    }\n    return calling;\n  };\n}\n/**\n * UIPlugin is the extended version of BasePlugin to incorporate rendering with Preact.\n * Use this for plugins that need a user interface.\n *\n * For plugins without an user interface, see BasePlugin.\n */\n\nvar _updateUI = /*#__PURE__*/_classPrivateFieldLooseKey(\"updateUI\");\nclass UIPlugin extends BasePlugin {\n  constructor() {\n    super(...arguments);\n    Object.defineProperty(this, _updateUI, {\n      writable: true,\n      value: void 0\n    });\n  }\n  getTargetPlugin(target) {\n    let targetPlugin;\n    if (typeof target === 'object' && target instanceof UIPlugin) {\n      // Targeting a plugin *instance*\n      targetPlugin = target;\n    } else if (typeof target === 'function') {\n      // Targeting a plugin type\n      const Target = target; // Find the target plugin instance.\n\n      this.uppy.iteratePlugins(p => {\n        if (p instanceof Target) {\n          targetPlugin = p;\n        }\n      });\n    }\n    return targetPlugin;\n  }\n  /**\n   * Check if supplied `target` is a DOM element or an `object`.\n   * If it’s an object — target is a plugin, and we search `plugins`\n   * for a plugin with same name and return its target.\n   */\n\n  mount(target, plugin) {\n    const callerPluginName = plugin.id;\n    const targetElement = findDOMElement(target);\n    if (targetElement) {\n      this.isTargetDOMEl = true; // When target is <body> with a single <div> element,\n      // Preact thinks it’s the Uppy root element in there when doing a diff,\n      // and destroys it. So we are creating a fragment (could be empty div)\n\n      const uppyRootElement = document.createElement('div');\n      uppyRootElement.classList.add('uppy-Root'); // API for plugins that require a synchronous rerender.\n\n      _classPrivateFieldLooseBase(this, _updateUI)[_updateUI] = debounce(state => {\n        // plugin could be removed, but this.rerender is debounced below,\n        // so it could still be called even after uppy.removePlugin or uppy.close\n        // hence the check\n        if (!this.uppy.getPlugin(this.id)) return;\n        render(this.render(state), uppyRootElement);\n        this.afterUpdate();\n      });\n      this.uppy.log(`Installing ${callerPluginName} to a DOM element '${target}'`);\n      if (this.opts.replaceTargetContent) {\n        // Doing render(h(null), targetElement), which should have been\n        // a better way, since because the component might need to do additional cleanup when it is removed,\n        // stopped working — Preact just adds null into target, not replacing\n        targetElement.innerHTML = '';\n      }\n      render(this.render(this.uppy.getState()), uppyRootElement);\n      this.el = uppyRootElement;\n      targetElement.appendChild(uppyRootElement); // Set the text direction if the page has not defined one.\n\n      uppyRootElement.dir = this.opts.direction || getTextDirection(uppyRootElement) || 'ltr';\n      this.onMount();\n      return this.el;\n    }\n    const targetPlugin = this.getTargetPlugin(target);\n    if (targetPlugin) {\n      this.uppy.log(`Installing ${callerPluginName} to ${targetPlugin.id}`);\n      this.parent = targetPlugin;\n      this.el = targetPlugin.addTarget(plugin);\n      this.onMount();\n      return this.el;\n    }\n    this.uppy.log(`Not installing ${callerPluginName}`);\n    let message = `Invalid target option given to ${callerPluginName}.`;\n    if (typeof target === 'function') {\n      message += ' The given target is not a Plugin class. ' + 'Please check that you\\'re not specifying a React Component instead of a plugin. ' + 'If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: ' + 'run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.';\n    } else {\n      message += 'If you meant to target an HTML element, please make sure that the element exists. ' + 'Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. ' + '(see https://github.com/transloadit/uppy/issues/1042)\\n\\n' + 'If you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.';\n    }\n    throw new Error(message);\n  }\n  update(state) {\n    if (this.el != null) {\n      var _classPrivateFieldLoo, _classPrivateFieldLoo2;\n      (_classPrivateFieldLoo = (_classPrivateFieldLoo2 = _classPrivateFieldLooseBase(this, _updateUI))[_updateUI]) == null ? void 0 : _classPrivateFieldLoo.call(_classPrivateFieldLoo2, state);\n    }\n  }\n  unmount() {\n    if (this.isTargetDOMEl) {\n      var _this$el;\n      (_this$el = this.el) == null ? void 0 : _this$el.remove();\n    }\n    this.onUnmount();\n  } // eslint-disable-next-line class-methods-use-this\n\n  onMount() {} // eslint-disable-next-line class-methods-use-this\n\n  onUnmount() {}\n}\nexport default UIPlugin;","map":{"version":3,"names":["_classPrivateFieldLooseBase","receiver","privateKey","Object","prototype","hasOwnProperty","call","TypeError","id","_classPrivateFieldLooseKey","name","render","findDOMElement","getTextDirection","BasePlugin","debounce","fn","calling","latestArgs","_len","arguments","length","args","Array","_key","Promise","resolve","then","_updateUI","UIPlugin","constructor","defineProperty","writable","value","getTargetPlugin","target","targetPlugin","Target","uppy","iteratePlugins","p","mount","plugin","callerPluginName","targetElement","isTargetDOMEl","uppyRootElement","document","createElement","classList","add","state","getPlugin","afterUpdate","log","opts","replaceTargetContent","innerHTML","getState","el","appendChild","dir","direction","onMount","parent","addTarget","message","Error","update","_classPrivateFieldLoo","_classPrivateFieldLoo2","unmount","_this$el","remove","onUnmount"],"sources":["/lab/node_modules/@uppy/core/lib/UIPlugin.js"],"sourcesContent":["function _classPrivateFieldLooseBase(receiver, privateKey) { if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) { throw new TypeError(\"attempted to use private field on non-instance\"); } return receiver; }\n\nvar id = 0;\n\nfunction _classPrivateFieldLooseKey(name) { return \"__private_\" + id++ + \"_\" + name; }\n\nimport { render } from 'preact';\nimport findDOMElement from '@uppy/utils/lib/findDOMElement';\nimport getTextDirection from '@uppy/utils/lib/getTextDirection';\nimport BasePlugin from './BasePlugin.js';\n/**\n * Defer a frequent call to the microtask queue.\n *\n * @param {() => T} fn\n * @returns {Promise<T>}\n */\n\nfunction debounce(fn) {\n  let calling = null;\n  let latestArgs = null;\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    latestArgs = args;\n\n    if (!calling) {\n      calling = Promise.resolve().then(() => {\n        calling = null; // At this point `args` may be different from the most\n        // recent state, if multiple calls happened since this task\n        // was queued. So we use the `latestArgs`, which definitely\n        // is the most recent call.\n\n        return fn(...latestArgs);\n      });\n    }\n\n    return calling;\n  };\n}\n/**\n * UIPlugin is the extended version of BasePlugin to incorporate rendering with Preact.\n * Use this for plugins that need a user interface.\n *\n * For plugins without an user interface, see BasePlugin.\n */\n\n\nvar _updateUI = /*#__PURE__*/_classPrivateFieldLooseKey(\"updateUI\");\n\nclass UIPlugin extends BasePlugin {\n  constructor() {\n    super(...arguments);\n    Object.defineProperty(this, _updateUI, {\n      writable: true,\n      value: void 0\n    });\n  }\n\n  getTargetPlugin(target) {\n    let targetPlugin;\n\n    if (typeof target === 'object' && target instanceof UIPlugin) {\n      // Targeting a plugin *instance*\n      targetPlugin = target;\n    } else if (typeof target === 'function') {\n      // Targeting a plugin type\n      const Target = target; // Find the target plugin instance.\n\n      this.uppy.iteratePlugins(p => {\n        if (p instanceof Target) {\n          targetPlugin = p;\n        }\n      });\n    }\n\n    return targetPlugin;\n  }\n  /**\n   * Check if supplied `target` is a DOM element or an `object`.\n   * If it’s an object — target is a plugin, and we search `plugins`\n   * for a plugin with same name and return its target.\n   */\n\n\n  mount(target, plugin) {\n    const callerPluginName = plugin.id;\n    const targetElement = findDOMElement(target);\n\n    if (targetElement) {\n      this.isTargetDOMEl = true; // When target is <body> with a single <div> element,\n      // Preact thinks it’s the Uppy root element in there when doing a diff,\n      // and destroys it. So we are creating a fragment (could be empty div)\n\n      const uppyRootElement = document.createElement('div');\n      uppyRootElement.classList.add('uppy-Root'); // API for plugins that require a synchronous rerender.\n\n      _classPrivateFieldLooseBase(this, _updateUI)[_updateUI] = debounce(state => {\n        // plugin could be removed, but this.rerender is debounced below,\n        // so it could still be called even after uppy.removePlugin or uppy.close\n        // hence the check\n        if (!this.uppy.getPlugin(this.id)) return;\n        render(this.render(state), uppyRootElement);\n        this.afterUpdate();\n      });\n      this.uppy.log(`Installing ${callerPluginName} to a DOM element '${target}'`);\n\n      if (this.opts.replaceTargetContent) {\n        // Doing render(h(null), targetElement), which should have been\n        // a better way, since because the component might need to do additional cleanup when it is removed,\n        // stopped working — Preact just adds null into target, not replacing\n        targetElement.innerHTML = '';\n      }\n\n      render(this.render(this.uppy.getState()), uppyRootElement);\n      this.el = uppyRootElement;\n      targetElement.appendChild(uppyRootElement); // Set the text direction if the page has not defined one.\n\n      uppyRootElement.dir = this.opts.direction || getTextDirection(uppyRootElement) || 'ltr';\n      this.onMount();\n      return this.el;\n    }\n\n    const targetPlugin = this.getTargetPlugin(target);\n\n    if (targetPlugin) {\n      this.uppy.log(`Installing ${callerPluginName} to ${targetPlugin.id}`);\n      this.parent = targetPlugin;\n      this.el = targetPlugin.addTarget(plugin);\n      this.onMount();\n      return this.el;\n    }\n\n    this.uppy.log(`Not installing ${callerPluginName}`);\n    let message = `Invalid target option given to ${callerPluginName}.`;\n\n    if (typeof target === 'function') {\n      message += ' The given target is not a Plugin class. ' + 'Please check that you\\'re not specifying a React Component instead of a plugin. ' + 'If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: ' + 'run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.';\n    } else {\n      message += 'If you meant to target an HTML element, please make sure that the element exists. ' + 'Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. ' + '(see https://github.com/transloadit/uppy/issues/1042)\\n\\n' + 'If you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.';\n    }\n\n    throw new Error(message);\n  }\n\n  update(state) {\n    if (this.el != null) {\n      var _classPrivateFieldLoo, _classPrivateFieldLoo2;\n\n      (_classPrivateFieldLoo = (_classPrivateFieldLoo2 = _classPrivateFieldLooseBase(this, _updateUI))[_updateUI]) == null ? void 0 : _classPrivateFieldLoo.call(_classPrivateFieldLoo2, state);\n    }\n  }\n\n  unmount() {\n    if (this.isTargetDOMEl) {\n      var _this$el;\n\n      (_this$el = this.el) == null ? void 0 : _this$el.remove();\n    }\n\n    this.onUnmount();\n  } // eslint-disable-next-line class-methods-use-this\n\n\n  onMount() {} // eslint-disable-next-line class-methods-use-this\n\n\n  onUnmount() {}\n\n}\n\nexport default UIPlugin;"],"mappings":"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"},"metadata":{},"sourceType":"module"}